<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily Emoji Check-In</title>
  <link rel="stylesheet" href="/styles.css" />
  <script src="/script.js"></script>
</head>

<body>
  <h1 id="headerText">Good Day! Drag the emojis to their matching spots ğŸŒ</h1>
  <div id="gameArea">
    <div class="baskets" id="baskets"></div>
    <div id="tray"></div>
    <div id="message"></div>
  </div>

  <script>
    const allEmojis = [
      "â˜€ï¸", "ğŸŒ¸", "ğŸ", "ğŸŒˆ", "ğŸ¢", "ğŸ•Šï¸", "ğŸŒ»", "ğŸ±", "ğŸ‹", "ğŸ‰",
      "ğŸ•", "ğŸŒ¹", "ğŸŒ™", "ğŸ‡", "ğŸŒ¾", "ğŸ‡", "ğŸŒ¼", "ğŸŠ", "ğŸ ", "ğŸ¦‹",
      "ğŸ€", "ğŸŒº", "ğŸ¦", "ğŸ¦œ", "ğŸŒ´", "ğŸ’", "ğŸŒ·", "ğŸ„", "ğŸª´"
    ];

    // === Time-based background & greeting ===
    function setTimeBasedBackground() {
      const hour = new Date().getHours();
      let bg = '';
      let greeting = '';
      let textcol = '#333';
      let isNight = false;

      if (hour >= 6 && hour < 12) {
        bg = 'linear-gradient(to top, #fdebd0, #f6ddcc, #fad7a0)';
        greeting = "Good Morning!";
      } else if (hour >= 12 && hour < 18) {
        bg = 'linear-gradient(to top, #ffd89b, #ffb347)';
        greeting = "Good Afternoon!";
      } else if (hour >= 18 && hour < 20) {
        bg = 'linear-gradient(to top, #f6a98f, #f28e63)';
        greeting = "Good Evening!";
      } else {
        bg = 'linear-gradient(to top, #2c3e50, #34495e)';
        greeting = "Good Night!";
        textcol = 'white';
        isNight = true;
      }

      document.body.style.background = bg;
      const header = document.getElementById("headerText");
      header.textContent = greeting + " Drag the emojis to their matching spots";
      header.style.color = textcol;

      // Adjust basket colors for night mode
      document.querySelectorAll('.basket').forEach(basket => {
        if (isNight) {
          basket.style.background = 'linear-gradient(to top, #4b5c6b, #2c3e50)';
          basket.style.borderColor = '#fff';
          basket.style.color = '#fff';
        } else {
          basket.style.background = 'linear-gradient(to top, #fffbe6, #ffe0b2)';
          basket.style.borderColor = '#f6c67a';
          basket.style.color = '#333';
        }
      });
    }

    // === Daily emoji swapping using seeds ===
    function getDailySeed() {
      const today = new Date();
      return today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
    }

    function seededRandom(seed) {
      const x = Math.sin(seed) * 10000;
      return x - Math.floor(x);
    }

    function getDailyEmojis(count = 3) {
      const copy = [...allEmojis];
      const chosen = [];
      const seed = getDailySeed();
      for (let i = 0; i < count; i++) {
        const index = Math.floor(seededRandom(seed + i) * copy.length);
        chosen.push(copy[index]);
        copy.splice(index, 1);
      }
      return chosen;
    }

    const dailyEmojis = getDailyEmojis();
    const baskets = document.getElementById("baskets");
    const tray = document.getElementById("tray");
    const message = document.getElementById("message");

    // create baskets with faint hints and tray items
    dailyEmojis.forEach(emoji => {
      const basket = document.createElement("div");
      basket.classList.add("basket");
      basket.dataset.item = emoji;
      basket.innerHTML = `<span>${emoji}</span>`;
      baskets.appendChild(basket);

      const item = document.createElement("div");
      item.classList.add("item");
      item.textContent = emoji;
      item.draggable = true;
      item.dataset.item = emoji;
      tray.appendChild(item);
    });

    setTimeBasedBackground(); // apply initial background

    let matched = 0;

    document.querySelectorAll(".item").forEach(item => {
      item.addEventListener("dragstart", e => {
        e.dataTransfer.setData("text", e.target.dataset.item);
      });
    });

    document.querySelectorAll(".basket").forEach(basket => {
      basket.addEventListener("dragover", e => e.preventDefault());
      basket.addEventListener("dragenter", e => basket.classList.add('active'));
      basket.addEventListener("dragleave", e => basket.classList.remove('active'));
      basket.addEventListener("drop", e => {
        e.preventDefault();
        basket.classList.remove('active');
        const draggedItem = e.dataTransfer.getData("text");
        if (draggedItem === basket.dataset.item && !basket.classList.contains("filled")) {
          basket.classList.add("filled");
          basket.innerHTML = `<span>${draggedItem}</span>`;
          document.querySelector(`.item[data-item='${draggedItem}']`).remove();
          matched++;
          if (matched === dailyEmojis.length) {
            message.textContent = "All matched! Checking in automaticallyâ€¦ âœ…";
            // Auto check-in call here
            setTimeout(() => {
              alert("You've checked in successfully! ğŸ’›");
              message.textContent = "Done! ğŸ‘";

            }, 500);
          }
        } else {
          message.textContent = "Not quite right, try again ğŸ™";
        }
      });
    });
  </script>
</body>

</html>